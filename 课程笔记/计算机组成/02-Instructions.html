<!DOCTYPE html>
<html lang="en" dir="ltr"><head><title>02 Instructions</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto Sans SC:wght@400;700&amp;family=Noto Serif SC:ital,wght@0,400;0,600;1,400;1,600&amp;family=JetBrains Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="ING wiki"/><meta property="og:title" content="02 Instructions"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="02 Instructions"/><meta name="twitter:description" content="summary 寄存器 registers flashcard RISC-V architecture 提供 32 个数据寄存器，分别命名为 x0 ~ x31 ，每个寄存器的大小是 64 位。 x0 的值恒为 0 Preserved on call 意为是否保证调用前后这些寄存器的值不变。 也提供一系列浮点数寄存器 f0 ~ f31。 之所以寄存器的个数不多，是因为过多的寄存器会增加电子信号的传播距离，从而导致时钟周期的延长。 将不常用的（或之后用到的）变量存入内存的过程被称为溢出寄存器 (Spilling Register) 寄存器存储空间小，内存存储空间大 因此小规模的数据会放在寄存器内，..."/><meta property="og:description" content="summary 寄存器 registers flashcard RISC-V architecture 提供 32 个数据寄存器，分别命名为 x0 ~ x31 ，每个寄存器的大小是 64 位。 x0 的值恒为 0 Preserved on call 意为是否保证调用前后这些寄存器的值不变。 也提供一系列浮点数寄存器 f0 ~ f31。 之所以寄存器的个数不多，是因为过多的寄存器会增加电子信号的传播距离，从而导致时钟周期的延长。 将不常用的（或之后用到的）变量存入内存的过程被称为溢出寄存器 (Spilling Register) 寄存器存储空间小，内存存储空间大 因此小规模的数据会放在寄存器内，..."/><meta property="og:image:alt" content="summary 寄存器 registers flashcard RISC-V architecture 提供 32 个数据寄存器，分别命名为 x0 ~ x31 ，每个寄存器的大小是 64 位。 x0 的值恒为 0 Preserved on call 意为是否保证调用前后这些寄存器的值不变。 也提供一系列浮点数寄存器 f0 ~ f31。 之所以寄存器的个数不多，是因为过多的寄存器会增加电子信号的传播距离，从而导致时钟周期的延长。 将不常用的（或之后用到的）变量存入内存的过程被称为溢出寄存器 (Spilling Register) 寄存器存储空间小，内存存储空间大 因此小规模的数据会放在寄存器内，..."/><meta property="twitter:domain" content="im0x0ing.github.io"/><meta property="og:url" content="https://im0x0ing.github.io/课程笔记/计算机组成/02-Instructions"/><meta property="twitter:url" content="https://im0x0ing.github.io/课程笔记/计算机组成/02-Instructions"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="summary 寄存器 registers flashcard RISC-V architecture 提供 32 个数据寄存器，分别命名为 x0 ~ x31 ，每个寄存器的大小是 64 位。 x0 的值恒为 0 Preserved on call 意为是否保证调用前后这些寄存器的值不变。 也提供一系列浮点数寄存器 f0 ~ f31。 之所以寄存器的个数不多，是因为过多的寄存器会增加电子信号的传播距离，从而导致时钟周期的延长。 将不常用的（或之后用到的）变量存入内存的过程被称为溢出寄存器 (Spilling Register) 寄存器存储空间小，内存存储空间大 因此小规模的数据会放在寄存器内，..."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" data-persist="true"/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvaW0weDBpbmctYmxvZy1wcml2YXRlL2ltMHgwaW5nLWJsb2ctcHJpdmF0ZS9xdWFydHovY29tcG9uZW50cy9zdHlsZXMiLCJzb3VyY2VzIjpbIm1lcm1haWQuaW5saW5lLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUdGO0VBQ0U7OztBQUtGO0VBQ0U7RUFDQTs7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7O0FBSUY7RUFDRTtFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhwYW5kLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBwYWRkaW5nOiAwLjRyZW07XG4gIG1hcmdpbjogMC4zcmVtO1xuICByaWdodDogMDsgLy8gTk9URTogcmlnaHQgd2lsbCBiZSBzZXQgaW4gbWVybWFpZC5pbmxpbmUudHNcbiAgY29sb3I6IHZhcigtLWdyYXkpO1xuICBib3JkZXItY29sb3I6IHZhcigtLWRhcmspO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gIGJvcmRlcjogMXB4IHNvbGlkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIG9wYWNpdHk6IDA7XG4gIHRyYW5zaXRpb246IDAuMnM7XG5cbiAgJiA+IHN2ZyB7XG4gICAgZmlsbDogdmFyKC0tbGlnaHQpO1xuICAgIGZpbHRlcjogY29udHJhc3QoMC4zKTtcbiAgfVxuXG4gICY6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXItY29sb3I6IHZhcigtLXNlY29uZGFyeSk7XG4gIH1cblxuICAmOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG59XG5cbnByZSB7XG4gICY6aG92ZXIgPiAuZXhwYW5kLWJ1dHRvbiB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2l0aW9uOiAwLjJzO1xuICB9XG59XG5cbiNtZXJtYWlkLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgY29udGFpbjogbGF5b3V0O1xuICB6LWluZGV4OiA5OTk7XG4gIGxlZnQ6IDA7XG4gIHRvcDogMDtcbiAgd2lkdGg6IDEwMHZ3O1xuICBoZWlnaHQ6IDEwMHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KTtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXG4gICYuYWN0aXZlIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIH1cblxuICAmID4gI21lcm1haWQtc3BhY2Uge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiA1MCU7XG4gICAgbGVmdDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgIGhlaWdodDogODB2aDtcbiAgICB3aWR0aDogODB2dztcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRlbnQge1xuICAgICAgcGFkZGluZzogMnJlbTtcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDtcbiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzIGVhc2U7XG4gICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICAgICAgbWluLXdpZHRoOiAyMDBweDtcblxuICAgICAgcHJlIHtcbiAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIHN2ZyB7XG4gICAgICAgIG1heC13aWR0aDogbm9uZTtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgfVxuICAgIH1cblxuICAgICYgPiAubWVybWFpZC1jb250cm9scyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBib3R0b206IDIwcHg7XG4gICAgICByaWdodDogMjBweDtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBnYXA6IDhweDtcbiAgICAgIHBhZGRpbmc6IDhweDtcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgei1pbmRleDogMjtcblxuICAgICAgLm1lcm1haWQtY29udHJvbC1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgd2lkdGg6IDMycHg7XG4gICAgICAgIGhlaWdodDogMzJweDtcbiAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgICBjb2xvcjogdmFyKC0tZGFyayk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1ib2R5Rm9udCk7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cbiAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgICY6YWN0aXZlIHtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0eWxlIHRoZSByZXNldCBidXR0b24gZGlmZmVyZW50bHlcbiAgICAgICAgJjpudGgtY2hpbGQoMikge1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIHBhZGRpbmc6IDAgMTJweDtcbiAgICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ== */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" data-persist="true"/><script src="../../prescript.js" type="application/javascript" data-persist="true"></script><script type="application/javascript" data-persist="true">const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://im0x0ing.github.io/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://im0x0ing.github.io/课程笔记/计算机组成/02-Instructions-og-image.webp"/><meta property="og:image:url" content="https://im0x0ing.github.io/课程笔记/计算机组成/02-Instructions-og-image.webp"/><meta name="twitter:image" content="https://im0x0ing.github.io/课程笔记/计算机组成/02-Instructions-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="课程笔记/计算机组成/02-Instructions"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">ING wiki</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>Search</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slug===\&quot;\&quot;||node.slug.startsWith(\&quot;\\u8BFE\\u7A0B\\u7B14\\u8BB0\&quot;)&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-29"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-29" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-3"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><header><nav class="my-navbar "><div class="links"><a href="/课程笔记/">课程笔记</a><a href="/技术积累/">技术积累</a><a href="/工具使用/">工具使用</a><a href="/生活杂谈/">生活杂谈</a></div></nav></header><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../课程笔记/">课程笔记</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../课程笔记/计算机组成/">计算机组成</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>02 Instructions</a></div></nav><h1 class="article-title">02 Instructions</h1><p show-comma="true" class="content-meta"><time datetime="2025-11-30T00:00:00.000Z">Nov 30, 2025</time><span>31 min read</span></p><ul class="tags"><li><a href="../../tags/flashcard" class="internal tag-link">flashcard</a></li></ul></div></div><article class="popover-hint"><h5 id="summary">summary<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#summary" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145502.png" width="auto" height="auto" alt/><br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145508.png" width="auto" height="auto" alt/><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145517.png" width="auto" height="auto" alt/><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145523.png" width="auto" height="auto" alt/><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145528.png" width="auto" height="auto" alt/><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145532.png" width="auto" height="auto" alt/><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145536.png" width="auto" height="auto" alt/></p>
<h4 id="寄存器-registers-flashcard">寄存器 registers <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#寄存器-registers-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>RISC-V architecture 提供 32 个数据寄存器，分别命名为 <code>x0</code> ~ <code>x31</code> ，每个寄存器的大小是 <code>64</code> 位。<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029142307.png" width="auto" height="auto" alt/>
<ul>
<li><code>x0</code> 的值恒为 0</li>
<li>Preserved on call 意为是否保证调用前后这些寄存器的值不变。</li>
</ul>
</li>
<li>也提供一系列浮点数寄存器 <code>f0</code> ~ <code>f31</code>。</li>
<li>之所以寄存器的个数不多，是因为过多的寄存器会增加电子信号的传播距离，从而导致时钟周期的延长。</li>
<li>将不常用的（或之后用到的）变量存入内存的过程被称为溢出寄存器 (Spilling Register)</li>
<li>寄存器存储空间小，内存存储空间大 因此小规模的数据会放在寄存器内，而更大规模的数据则会存储在计算机的<strong>内存</strong>(memory) 中</li>
<li>各种操作与运算都只能在寄存器内完成</li>
<li>寄存器有着更快的运行速度和更高的吞吐量，使得访问寄存器内的数据更加迅速和方便，且访问寄存器的能耗更低；而访问内存需要 <code>load</code> 和 <code>store</code> 指令，那么就需要执行更多的指令</li>
</ul>

<h4 id="字节地址-flashcard">字节地址 <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#字节地址-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029142656.png" width="auto" height="auto" alt/></p>
<ul>
<li>==在 RISC-V architecture 中，一个 <strong>word</strong> 为 32 位（4Bytes ），一个 <strong>doubleword</strong> 为 64 位（8Bytes ）。==</li>
<li>RISC-V architecture 的地址是 <span class="text-highlight">64 位</span>的，地址为字节地址，因此总共可以寻址2的64次方个字节，即2的61次方个 dword ，因为一个 dword 占3位（8Bytes用3个字节地址位表示）。
<ul>
<li>如果想操作某一个 bit（比如把第 3 个 bit 从 0 改成 1 ），CPU 必须：
<ol>
<li><strong>读取 (Read)</strong>：先把这个 bit 所在的整个字节（整个房间）的数据（8个 bits）全部取到 CPU 寄存器中。</li>
<li><strong>修改 (Modify)</strong>：在 CPU 内部，使用<strong>位运算</strong>（比如 <code>OR</code> 运算）来单独修改那 1 个 bit，而其他 7 个 bit 保持不变。</li>
<li><strong>写回 (Write)</strong>：把修改后的整个字节（8个 bits）再存回到原来的内存地址</li>
</ol>
</li>
</ul>
</li>
</ul>

<h4 id="寻址-flashcard">寻址 <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#寻址-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>在一些 architecture 中，word 的起始地址必须是 word 大小的整倍数，dword 也一样，这种要求称为 <strong>alignment restriction</strong>。
<ul>
<li>RISC-V 允许不对齐的寻址，但是效率会低。<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029142726.png" width="auto" height="auto" alt/></li>
<li><span class="text-highlight">一次只能读出4字节内存中的一行</span></li>
</ul>
</li>
<li>RISC-V 支持
<ul>
<li>立即数寻址 ( <code>lui</code> )</li>
<li>间接寻址 ( <code>jalr</code> )</li>
<li>基址寻址 ( <code>8(sp)</code> )：</li>
<li>PC relative 寻址：分支地址为PC和分支偏移量（立即数的2倍）之和
<ul>
<li>因为所有合法的指令<strong>必须</strong>存放在<strong>偶数</strong>内存地址【指令：16bit（压缩指令）/32bit 】因此最低位始终为0，因此为了优化，指令中会略去最后一个0</li>
<li>把存储的 <code>immediate</code> 还原成真正的 <code>Branch offset</code><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029142922.png" width="auto" height="auto" alt/><br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029133757.png" width="auto" height="auto" alt/></li>
</ul>
</li>
</ul>
</li>
</ul>


<h4 id="大小端-flashcard">大小端 <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#大小端-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>RISC-V 使用 <strong>little endian</strong> 小端编址。也就是说，当我们从 0x1000 这个地址读出一个 dword 时，我们读到的实际上是 0x1000~0x1007 这 8 个字节，并将 0x1000 存入寄存器低位，0x1007 存入高位。<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029133650.png" width="auto" height="auto" alt/>
<ul>
<li>存储字节 0x88 就是 bit：10001000</li>
<li><span class="text-highlight">大小端只关心字节的顺序，不关心字节内部bit的顺序</span></li>
</ul>
</li>
</ul>

<h4 id="补码-2s-complement-flashcard">补码 2’s complement <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#补码-2s-complement-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029134100.png" width="auto" height="auto" alt/><br/>
因此在将不足 64 位的数据载入寄存器时</p>
<ul>
<li>如果数据是<span class="text-highlight">无符号数</span>，只需要使用 0 将寄存器的其他部分填充 (<strong>zero extension</strong>)
<ul>
<li>指令中的<code>lwu</code> , <code>lhu</code> , <code>lbu</code> 使用zero extension。</li>
</ul>
</li>
<li>而如果是<span class="text-highlight">有符号数</span>，则需要用最高位即符号位填充剩余部分，称为符号扩展 (<strong>sign extension</strong>)。
<ul>
<li>指令中的 <code>lw</code> , <code>lh</code> , <code>lb</code> 使用sign extension<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029134303.png" width="auto" height="auto" alt/></li>
</ul>
</li>
</ul>
<ol>
<li>对于补码先看符号位，负数的话就对数字部分做补码还原，还是取反加一。</li>
<li>1’scomplement是反码，先看符号位，负数就对数字部分做反码还原，取反即可</li>
</ol>

<h2 id="指令">指令<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#指令" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="设计准则">设计准则<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#设计准则" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>正则化 simplicity favors regularity 简化规范<br/>
越小越快 smaller is faster 32个通用寄存器 32*64bit</p>
<h3 id="指令-1">指令<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#指令-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029134644.png" width="auto" height="auto" alt/></p>
<h4 id="arithmetic">Arithmetic<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#arithmetic" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>加法
<ul>
<li><code>add</code>：寄存器 1 + 寄存器 2<br/>
|<code>add reg1, reg2, reg3    // (in C) reg1 = reg2 + reg3</code>|</li>
<li><code>addi</code>(Add Immediate)：寄存器 + 常量<br/>
|<code>addi reg1, reg2, const  // (in C) reg1 = reg2 + const</code>|</li>
</ul>
</li>
<li>减法
<ul>
<li><code>sub</code>：寄存器 1 - 寄存器 2<br/>
|<code>sub reg1, reg2, reg3    // (in C) reg1 = reg2 - reg3</code>|</li>
<li>==注意：没有<code>subi</code>，但是可以通过<code>addi</code>一个负常数来实现==</li>
</ul>
</li>
</ul>
<h4 id="logical-operations">Logical Operations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#logical-operations" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029135807.png" width="auto" height="auto" alt/></p>
<ul>
<li><code>sll</code>/<code>slli</code>，<code>srl</code>/<code>srli</code> 分别为逻辑左移/右移
<ul>
<li>左移i位相当于乘以2的i次方，右移i位相当于整除2的i次方 </li>
<li>逻辑右移时最左边补 0</li>
<li>不带<code>i</code>的指令表示根据<span class="text-highlight">寄存器的值</span>确定移动位数，带<code>i</code>的指令表示用立即数确定移动位数<br/>
|<code>slli x11, x19, 4    // reg x11 = reg x19 &lt;&lt; 4 bits</code>|</li>
</ul>
</li>
<li><code>sra</code>/<code>srai</code> 为算术右移，最左边补符号位</li>
</ul>
<h4 id="bit-operations">Bit Operations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#bit-operations" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>|and reg1, reg2, reg3    // (in C) reg1 = reg2 &amp; reg3`|<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140018.png" width="auto" height="auto" alt/></p>
<p>|or reg1, reg2, reg3    // (in C) reg1 = reg2 | reg3`|</p>
<ul>
<li>AND、OR、XOR 也有立即数版本的指令，分别为：<code>andi</code>、<code>ori</code>和<code>xori</code><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140028.png" width="auto" height="auto" alt/></li>
</ul>
<p>|xor reg1, reg2, reg3    `|</p>
<ul>
<li>RISC-V 中没有 NOT 指令，因为它可以通过异或表示出来：任何数与 111…111 异或的结果即为该数取反后的结果<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140033.png" width="auto" height="auto" alt/></li>
</ul>
<h4 id="making-decisions">Making Decisions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#making-decisions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>计算机与计算器的一大不同之处在于计算机具备决策的能力：它能够执行分支（条件）语句、循环语句等。<br/>
在 RISC-V 汇编语言中，关于决策的指令格式均为：<code>inst rs1, rs2, L1</code></p>
<ul>
<li>其中<code>rs1</code>、<code>rs2</code>是寄存器</li>
<li><code>L1</code>是标签（跳转位置<span class="text-highlight">，也可以是立即数 imm，表示跳转到 PC+imm 的指令</span>）</li>
<li><code>inst</code>是指令，比较的是补码值。/0</li>
</ul>
<p>其分类如下：</p>
<ul>
<li><strong>条件分支</strong>(conditional branch)：先检测值，根据检测结果决定是否将控制权转交给新地址上的语句的一类指令</li>
<li><strong>无条件分支</strong>(unconditional branch)：条件恒为真的条件分支，因此该语句一定会执行</li>
</ul>
<p>有以下几种可用指令：</p>
<ul>
<li><code>beq</code>(Branch If <span class="text-highlight">Equal</span>)：如果寄存器<code>rs1</code>和<code>rs2</code>的值<strong>相等</strong>，那么跳转至带标签<code>L1</code>的语句</li>
<li><code>bne</code>(Branch If <span class="text-highlight">Not Equal</span>)：如果寄存器<code>rs1</code>和<code>rs2</code>的值<strong>不相等</strong>，那么跳转至带标签<code>L1</code>的语句</li>
<li><code>blt</code>(Branch If <span class="text-highlight">Less Than</span>)：如果寄存器<code>rs1</code>的值<strong>小于</strong><code>rs2</code>的值，那么跳转至带标签<code>L1</code>的语句
<ul>
<li><code>bltu</code>：无符号版本 unsigned 比如存的是地址，就只能用bltu当作无符号数来比较，否则会引入符号位。【如果高位地址用不上也不容易出错，如果地址比较大就一定要bltu】</li>
</ul>
</li>
<li><code>bge</code>(Branch If <span class="text-highlight">Greater</span> Than or <span class="text-highlight">Equal</span>)：如果寄存器<code>rs1</code>的值<strong>大于等于</strong><code>rs2</code>的值，那么跳转至带标签<code>L1</code>的语句
<ul>
<li><code>bgeu</code>：无符号版本 unsigned</li>
</ul>
</li>
</ul>
<h5 id="if">if<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#if" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140744.png" width="auto" height="auto" alt/></p>
<h5 id="if-else">if-else<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#if-else" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140803.png" width="auto" height="auto" alt/></p>
<h5 id="case-switch">case-switch<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#case-switch" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>对于<code>case/switch</code>语句，我们可以使用一张放有可选指令序列地址的表格（称为<strong>分支地址表</strong>，Branch Address Table），这样的话程序就可以根据条件判断的结果，通过表格的索引找到合适的指令序列。<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140825.png" width="auto" height="auto" alt/><br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140843.png" width="auto" height="auto" alt/><br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140849.png" width="auto" height="auto" alt/></p>
<h5 id="loops">loops<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#loops" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<ul>
<li>循环访问数组<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140921.png" width="auto" height="auto" alt/></li>
<li>while<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029140932.png" width="auto" height="auto" alt/></li>
</ul>
<h4 id="set-on-less-than">set on less than<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#set-on-less-than" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<pre><code>slt x5, x19, x20
</code></pre>
<p>如果 x19&lt;x20，那么将 x5 赋值为 1<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029141028.png" width="auto" height="auto" alt/></p>
<h4 id="data-transfer-instructions">Data Transfer Instructions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#data-transfer-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>由于对数据的各种操作只能在寄存器内完成，而无法在内存中实现，因此数据需要再寄存器和内存之间来回传递，来完成这一传递操作的指令被称为<strong>数据传输指令</strong><br/>
RISC-V 有以下数据传输指令：</p>
<ul>
<li><code>ld</code>（Load Doubleword）：加载指令，将数据从内存拷贝到寄存器当中<br/>
|<code>ld reg, offset(mem_base_addr) </code>|
<ul>
<li>reg: 寄存器</li>
<li>mem_base_addr: 一个保存内存基础地址的寄存器（可以理解为能访问到整个内存的头指针）</li>
<li>offset: 偏移量，是一个常数</li>
<li>内存数据的实际地址 = <code>mem_base_addr + offset</code></li>
</ul>
</li>
<li><code>sd</code>（Store Doubleword）：存储指令，将寄存器的数据拷贝到内存中<br/>
|`sd reg, offset(mem_base_addr) |
<ul>
<li>reg: 寄存器</li>
<li>mem_base_addr: 内存基础地址寄存器</li>
<li>offset: 偏移量</li>
</ul>
</li>
<li><code>lbu</code>(Load Byte Unsigned)：加载 1 字节的数据，并看作无符号数</li>
<li><code>lb</code>(Load Byte)：<code>lbu</code>的有符号数版本</li>
</ul>
<blockquote>
<p>在 RISC 指令集中，只有 load 系列和 store 系列指令能够访问内存。<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029143831.png" width="auto" height="auto" alt/></p>
</blockquote>
<h4 id="立即数-constant-or-immediate-operands">立即数 Constant or Immediate Operands<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#立即数-constant-or-immediate-operands" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>一般的做法是将常数保存在一个寄存器当中，通过一个地址指针指向这个寄存器，然后通过 <code>add</code> 指令实现加法操作<br/>
|<code>ld x9, AddrConstant4(x3) //x9 = constant 4 add x22, x22, x9</code>|</li>
<li>实际上我们可以引入一个新的概念：立即数（Immediate），这样就避免了加载指令（即通过操作 <code>addi x22, x22, 4</code> 即可实现）</li>
</ul>
<h4 id="同步synchronization-in-risc-v">同步Synchronization in RISC-V<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#同步synchronization-in-risc-v" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>假设两个处理器在同一片内存空间中工作，并且它们的工作顺序为：P1写入数据后，P2再读取数据。没有<strong>同步</strong>（Synchoronize）好，那么就会产生<strong>数据竞争</strong>（Data Race）的问题（结果取决于访问顺序，因此这个结果就是不确定的）。</p>
<p>避免这一问题的方法是<strong>原子</strong>读取 / 写入 (Atomic Read/Write) 内存操作，这种操作确保读和写之间不会有任何访问这块内存空间的行为。</p>
<p>有些处理器有专门实现原子操作的指令，比如原子交换 (Atomic Swap/Exchange)（实现寄存器和内存数据的交换）等。而 RISC-V 提供了一个指令对 (Instruction Pair) <code>lr.d</code>和<code>sc.d</code>：</p>
<ul>
<li><code>lr.d</code>（Load-Reserved Doubleword）：
<ul>
<li><code>lr.d rd, (rs1)</code> 将存储在寄存器<code>rs1</code>的内存地址上的数据加载到寄存器<code>rd</code>上，同时保留这块内存地址，除<code>sc.d</code>的其他指令不应该访问这块地址</li>
</ul>
</li>
<li><code>sc.d</code>（Store-Conditional Doubleword）：
<ul>
<li><code>sc.d rd, rs1, (rs2)</code> 将寄存器<code>rs1</code>上的数据放入存储在寄存器<code>rs2</code>的内存地址上，并且由寄存器<code>rd</code>指示该指令是否成功：若成功，则<code>rd = 0</code>，否则<code>rd</code>为一个非零值（表示有其他指令访问过这块内存空间）<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029144223.png" width="auto" height="auto" alt/></li>
</ul>
</li>
</ul>
<h3 id="其他">其他<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#其他" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145424.png" width="auto" height="auto" alt/><br/>
拓展指令集内容：</p>
<ul>
<li>M：与乘除法相关的指令</li>
<li>A：原子运算，包括前面提到过的<code>lr.d</code>和<code>sc.d</code>指令，以及它们的 32 位版本<code>lr.w</code>和<code>sc.w</code>等</li>
<li>F：单精度浮点运算相关指令</li>
<li>D：双精度浮点运算相关指令</li>
<li>C：压缩的指令，只有 16 位宽<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029134805.png" width="auto" height="auto" alt/></li>
</ul>
<h3 id="伪指令">伪指令<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#伪指令" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029134805.png" width="auto" height="auto" alt/></p>
<h3 id="过程procedure或函数function">过程（Procedure）或函数（Function）<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#过程procedure或函数function" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="调用过程procedure-call-instructions-flashcard">调用过程Procedure Call Instructions <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#调用过程procedure-call-instructions-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251105134331.png" width="auto" height="auto" alt/></p>
<ul>
<li>jal与jalr
<ul>
<li>jalr是基于【寄存器地址+12位立即数偏移量】</li>
<li>jal是基于pc相对地址【20位立即数】，jal rd，offset</li>
</ul>
</li>
<li>对于调用者：调用某个程序地址后，将返回地址（跳转的下一条地址PC+4）存入x1（ra）中</li>
<li>对于被调用者，x0无法被写入，表示不保存任何返回地址，仅作跳转。</li>
</ul>
<h4 id="调用过程中的寄存器registers-for-procedure-calling">调用过程中的寄存器Registers for procedure calling<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#调用过程中的寄存器registers-for-procedure-calling" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><a href="../../ABI-(Application-Binary-Interface)#risc-v寄存器-flashcard" class="internal alias" data-slug="ABI-(Application-Binary-Interface)">RISC-V寄存器 flashcard</a></p>
<h4 id="local-data-on-the-stack">Local Data on the <strong>Stack</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#local-data-on-the-stack" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><a href="../../ABI-(Application-Binary-Interface)#栈与栈帧-flashcard" class="internal alias" data-slug="ABI-(Application-Binary-Interface)">栈与栈帧 flashcard</a></p>
<h4 id="memory-layout">Memory Layout<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#memory-layout" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><a href="../../ABI-(Application-Binary-Interface)#memory-layout-flashcard" class="internal alias" data-slug="ABI-(Application-Binary-Interface)">Memory Layout flashcard</a></p>
<h2 id="ricv-v指令格式-flashcard">RICV-V指令格式 <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ricv-v指令格式-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>指令编码32bit, 记其为机器码（Machine Code）。我们可以把每条指令当作一块块二进制数字构成的组合，而这单块的数字被称为<strong>字段</strong>（Field）。我们为字段赋予了一些名称，每个字段有不同的功能：</p>
<ul>
<li><code>opcode</code>：指令要做的运算，可用这个字段区分各种类型的<strong>指令格式</strong>(instruction format)</li>
<li><code>funct3</code>：额外的<code>opcode</code>字段</li>
<li><code>funct7</code>：额外的<code>opcode</code>字段</li>
<li><code>rd</code>：寄存器目标操作数，保存运算的结果</li>
<li><code>rs1</code>：第一个寄存器源操作数</li>
<li><code>rs2</code>：第二个寄存器源操作数</li>
<li><code>immediate</code>：立即数，即常数<br/>
根据不同的 opcode 我们可以将指令分为 6 种类型，它们的字段构成如下：</li>
</ul>
<ol>
<li>R 型指令一般用于算术、逻辑运算</li>
<li>I 型指令一般用于加载操作、涉及立即数的算术逻辑运算、<code>jalr</code>指令
<ol>
<li>因为寄存器的大小为 64 位，也就是说对于移位操作 <code>slli</code>，<code>srli</code>和<code>srai</code>，它们最多只能移位 64 位，因此移位操作中<code>immediate</code>字段只有后 6 位能实际被用来存储移位的步数，前 6 位用来存储额外的<code>opcode</code>字段（<code>funct6</code>）</li>
<li>关于 <code>jalr</code> 指令，如果跳转地址（立即数）过大，超过了 20 位，那么可以先用 <code>lui</code> 指令将高 20 位数字放入临时寄存器中，然后再用 <code>jalr</code> 指令跳转到地址剩余的低位数字(临时寄存器)上</li>
</ol>
</li>
<li>S 型指令一般用于存储操作</li>
<li>U 型指令一般用于与高位立即数相关的操作
<ol>
<li>在大多数情况下，立即数不会很大（），能够直接存在指令中；但如果超过 12 位，RISC-V 会用 <code>lui</code> (load upper immediate) 指令来处理这类较大的立即数。</li>
<li>它可以加载立即数的<strong>高 20 位</strong>，将其放入寄存器中间的第 12 位到第 31 位，寄存器的低 12 位用 0 填充，高 32 位用第 31 位上的数字填充。</li>
<li>例如，要将 32 位立即数赋给寄存器，可以先用<code>lui</code>指令将高 20 位赋给寄存器，之后用<code>addi</code> 指令将剩余的 12 位加到寄存器中。</li>
</ol>
</li>
<li>SB 型指令一般用于条件分支语句
<ul>
<li>可表示的地址范围为 -4096-4094，且都是 2 的倍数（因为立即数第一位恒为 0）</li>
</ul>
</li>
<li>UJ 型指令一般用于无条件分支语句（<code>jal</code>）
<ul>
<li><code>rd</code>用于存放链接地址（即返回地址）<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029134654.png" width="auto" height="auto" alt/></li>
</ul>
</li>
</ol>
<ul>
<li>另外，为什么 <code>SB</code> 和 <code>UJ</code> 不存立即数（也就是偏移）的最低位呢？（关注表格，可以发现只包括 <code>i[12:1]</code> 或者 <code>i[20:1]</code>，缺失 <code>i[0]</code>）<span class="text-highlight">因为，偏移的最后一位一定是 0，即地址一定是 2 字节对齐的，因此没有必要保存。</span></li>
</ul>

<h2 id="数组和指针">数组和指针<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#数组和指针" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>事实上，用指针访问数组元素比用索引访问数组元素更快一些。它们分别具有如下特点：</p>
<ul>
<li>数组索引
<ul>
<li>需要根据数组基地址、当前索引和元素大小计算出数组元素的地址，而且每趟循环都需要更新和重新计算，有些麻烦</li>
<li>虽然从理论上来说效率不高，但实际上编译器已经为我们做了一定的优化，比如用移位运算替代乘法运算，避免在循环内进行数组地址计算等</li>
</ul>
</li>
<li>指针
<ul>
<li>它直接指向内存地址（可以看到，在循环开始前就已经算好了），无需多余的计算步骤</li>
</ul>
</li>
</ul>
<h2 id="例子">例子<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#例子" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>RISC-V 汇编语言来翻译一个用 C 语言写的冒泡排序函数<br/>
<span class="text-highlight">C 语言翻译成汇编语言步骤</span></p>
<ol>
<li>为程序的每个变量分配相应的寄存器</li>
<li>为过程的主体部分书写代码</li>
<li>在过程调用期间保留要用的寄存器</li>
</ol>
<p>swap函数</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c++" data-theme="github-light github-dark"><code data-language="c++" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[], </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> temp;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    temp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v<span class="orange-comment">[k]</span>;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    v<span class="orange-comment">[k]</span> </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    v[k</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> temp;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c++" data-theme="github-light github-dark"><code data-language="c++" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">swap:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    slli x6, x11, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // reg x6 = k * 8 -》变成byte字节地址</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    add  x6, x10, x6</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // reg x6 = v + (k * 8)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x5, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x6)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // reg x5 (temp) = v<span class="orange-comment">[k]</span></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x7, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x6)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // reg x7 = v<span class="orange-comment">[k + 1]</span></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x7, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x6)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // v<span class="orange-comment">[k]</span> = reg x7</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x5, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x6)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // v<span class="orange-comment">[k+1]</span> = reg x5 (tmp)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    jalr x0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x1)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // return to calling routine</span></span></code></pre></figure>
<p>sort函数</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c++" data-theme="github-light github-dark"><code data-language="c++" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> long</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[], </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">size_t</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> n</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    size_t</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i, j;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> n; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v<span class="orange-comment">[j]</span> </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> v[j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]; j</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">--</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            swap</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v, j);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c++" data-theme="github-light github-dark"><code data-language="c++" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Saving registers</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sort:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    addi sp, sp, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // make room on stack for 5 registers</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x1, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // save return address on stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x22, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // save x22 on stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x21, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // save x21 on stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x20, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // save x20 on stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    sd   x19, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // save x19 on stack</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Procedure body</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Move parameters</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mv   x21, x10</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // copy parameter x10 into x21</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mv   x22, x11</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // copy parameter x11 into x22</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Outer loop</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    li   x19, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           // i = 0</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">for1tst: </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    bge  x19, x22, exit1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // go to exit1 if i >= n</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Inner loop</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    addi x20, x19, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // j = i - 1</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">for2tst:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    blt  x20, x0, exit2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // go to exit2 if j &lt; 0</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    slli x5, x20, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // x5 = j * 8</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    add  x5, x21, x5</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // x5 = v + (j * 8)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x6, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x5)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // x6 = v<span class="orange-comment">[j]</span></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x7, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x5)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // x7 = v<span class="orange-comment">[j + 1]</span></span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ble  x6, x7, exit2</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // go to exit2 if x6 &lt; x7</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pass parameters and call</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mv   x10, x21</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // first swap parameter is v</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mv   x11, x20</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // second swap parameter is j</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    jal  x1, swap</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">         // call swap</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Inner loop</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    addi x20, x20, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // j for2tst</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    j for2tst</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             // go to for2tst</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Outer loop</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">exit2: </span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    addi x19, x19, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // i++</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    j for1tst</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">             // go to for1tst</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Restoring registers</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">exit1:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x19, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // restore x19 from stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x20, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // restore x20 from stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x21, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // restore x21 from stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x22, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // restore x22 from stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ld   x1, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(sp)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // restore return address from stack</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    addi sp, sp, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">40</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // restore stack pointer</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Procedure return</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    jalr x0, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x1)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // return to calling routine</span></span></code></pre></figure>
<h2 id="指令集架构">指令集架构<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#指令集架构" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h4 id="谬误">谬误<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#谬误" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>更多强大的指令会带来更高的性能
<ul>
<li>虽然更强大的指令意味着执行相同功能所需指令数更少，但同时也意味着这些指令会更加复杂，难以实现，这样反而影响所有指令的效率</li>
</ul>
</li>
<li>直接用汇编语言编写的程序性能更高
<ul>
<li>在现代的处理器中，编译器可能比人脑更擅长将高级语言代码转换为性能更优的汇编语言代码</li>
<li>而且，对于人类来说，因为汇编代码量较大，所以会带来更多犯错的机会，且编写效率实在不高</li>
</ul>
</li>
<li>指令集的向后兼容意味着无需改变现有的指令集
<ul>
<li>以 x86 为例，虽然它做到了向后兼容，但它的指令数还是呈上升趋势</li>
</ul>
</li>
<li>用字节表示地址的机器内，连续的字地址的间距不是 1 而是 4（字节）
<ul>
<li>一个地址只能放一个字节</li>
<li>双字地址间距就是8字节</li>
</ul>
</li>
<li>使用指向在定义过程外的自动变量的指针
<ul>
<li>典型例子：某个过程返回一个指向局部数组的指针，但这个过程在返回后就没了，包括这个局部数组，因此这个指针指向一个没有任何意义的地方，如果动用这个指针，很可能会让整个程序崩溃</li>
</ul>
</li>
</ul>
<h4 id="指令集架构-instruction-set-architecture-flashcard">指令集架构 instruction set architecture <a href="../.././../tags/flashcard" class="tag-link internal alias" data-slug="tags/flashcard">flashcard</a><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#指令集架构-instruction-set-architecture-flashcard" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>目前世界上主流的 ISA 主要分为两大类：</p>
<ul>
<li><strong>CISC (复杂指令集)</strong>：一条指令可以完成很复杂的操作。
<ul>
<li>x86 电脑、笔记本、服务器</li>
</ul>
</li>
<li><strong>RISC (精简指令集)</strong>：指令都很简单、统一，通过组合简单指令来完成复杂任务。
<ul>
<li>RISC-V</li>
<li>ARM  手机 平板 嵌入式设备 苹果电脑</li>
<li>MIPS<br/>
当下计算机建立在两个关键原则（即存储程序概念，Stored-Program Concept）：</li>
</ul>
</li>
<li>指令用数字来表示</li>
<li>程序就像数字一样存储在内存中，可用来被读取或写入</li>
</ul>


<h3 id="mips">MIPS<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mips" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>32 位指令</li>
<li>32 个通用寄存器，其中一个寄存器的值始终为 0</li>
<li>只能通过加载和存储指令来访问内存数据</li>
<li>没有能够批量加载 / 存储多个寄存器的指令</li>
<li>寻址模式适用于各种大小的数据</li>
</ul>
<p>RISC-V 和 MIPS 的不同之处有：</p>
<ul>
<li>条件分支（除了相等和不等）：
<ul>
<li>RISC-V 仅仅比较两个寄存器的大小，而 MIPS 还会用一个寄存器存储比较结果（1 或 0，对应真值）</li>
<li>MIPS 只有“小于”分支指令，该指令有符号数（<code>slt</code>）和无符号数（<code>sltu</code>）版本</li>
<li><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145124.png" width="auto" height="auto" alt/></li>
</ul>
</li>
<li>指令格式的区别<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145133.png" width="auto" height="auto" alt/></li>
</ul>
<h3 id="x86">x86<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#x86" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>8086 指令集仅支持字节（8 位）和字（<span class="text-highlight">16 位，注意 RISC-V 的字是 32 位</span>）类型的数据，而 80386 增加了 32 位地址和数据（<span class="text-highlight">双字，注意 RISC-V 的双字是 64 位</span>）。<br/>
x86 指令与 RISC-V 的不同之处在于：</p>
<ul>
<li>x86 指令的算术和逻辑指令中，有一个操作数同时充当源和目标；而 RISC-V（以及 MIPS）会将源寄存器和目标寄存器区分开来</li>
<li>x86 指令的其中一个操作数可以是内存，下面的表格展示了 x86 中所有可能的操作数搭配<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145250.png" width="auto" height="auto" alt/></li>
</ul>
<h5 id="寄存器">寄存器<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#寄存器" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>80386 指令集有 14 个寄存器，如下图所示：<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145304.png" width="auto" height="auto" alt/></p>
<h5 id="寻址模式">寻址模式<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#寻址模式" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>80386 的寻址模式如下图所示：<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145328.png" width="auto" height="auto" alt/></p>
<h5 id="指令格式">指令格式<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#指令格式" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>下图为典型 x86 指令格式<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145344.png" width="auto" height="auto" alt/>- 每条指令的开头（左侧）指明了指令要做的操作</p>
<ul>
<li>有些指令存在一个 <code>Postbyte</code> 字段，它用来指明寻址模式<br/>
x86 的整数指令有以下几类：</li>
<li>数据传送指令</li>
<li>算术和逻辑指令</li>
<li>控制流</li>
<li>字符串指令<br/>
分别对应的常见指令有：<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029145402.png" width="auto" height="auto" alt/></li>
</ul>
<h2 id="translating-and-starting-a-program">Translating and starting a program<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#translating-and-starting-a-program" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>一个 C 语言的程序（源代码）转化为存储在内存中的一个文件的过程<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251029144324.png" width="auto" height="auto" alt/></p>
<ul>
<li>编译器 (Compiler)：高级编程语言 <span>→</span> 汇编语言
<ul>
<li>有的编译器兼具汇编器的功能</li>
</ul>
</li>
<li>汇编器 (Assembler)：
<ul>
<li>伪指令 <span>→</span> 指令
<ul>
<li><strong>伪指令</strong>(Pseudo Instruction)：可以理解为汇编指令的扩展（或者缩写），形式上看似指令，而实际上并不存在这种指令，但汇编器会将其自动转化为实际存在的指令</li>
</ul>
</li>
<li>可接受各种进制的数</li>
<li>用<strong>符号表</strong>(symbol table) 存储标签名称和内存地址的对应关系，便于将标签转化为实际的地址</li>
<li>基本的功能：汇编语言 <span>→</span> 机器码，即汇编程序 <span>→</span> <strong>目标文件</strong>(Object File)。在 UNIX 系统中，目标文件包含以下内容：
<ul>
<li>目标文件头 (Object File Header)：描述目标文件中其他区域的大小和位置</li>
<li>文本段 (Text Segment)：包含机器码</li>
<li>静态数据段 (Static Data Segment)：包含程序生命周期中分配的数据（在 UNIX 中这个区域同时存放静态和动态数据）</li>
<li>重定位信息 (Relocation Information)：根据程序被加载至内存的绝对地址来区分指令和数据</li>
<li>符号表 (Symbol Table)</li>
<li>调试信息 (Debugging Information)：简要描述模块的编译情况，使调试器能够将机器指令和 C 源文件关联起来，且能够读取其中的数据结构</li>
</ul>
</li>
</ul>
</li>
<li>链接器 (Linker)
<ul>
<li>对于多文件的编译，采取的做法是先编译、汇编单个的文件，然后将这些机器语言程序链接起来，这样可以尽可能减少重编译和重汇编的情况</li>
<li>工作流程：
<ul>
<li>将代码和数据模块以符号化的形式存在内存中</li>
<li>弄清数据和指令标志对应的地址</li>
<li>补充好内部和外部的引用</li>
</ul>
</li>
<li>经链接器加工后，最终生成一个可执行文件 (Executable File)，它与目标文件的区别在于后者存在不确定 (Unresolved) 的引用</li>
</ul>
</li>
<li>加载器 (Loader)：将可执行文件放入内存或磁盘中，工作流程为：
<ul>
<li>读取可执行文件头，得到文本段和数据段的大小</li>
<li>创建一个指向足够容纳文本和数据的空间的地址</li>
<li>将可执行文件的指令和数据拷贝到内存中</li>
<li>将主程序的参数（如果有的话）放入栈中</li>
<li>对寄存器进行初始化操作，并将栈指针指向第一个空闲的位置上</li>
<li>跳转到启动例程，将参数拷贝到参数寄存器中，并调用程序的主例程。让主例程返回时，启动例程中止整个程序，附带<code>exit</code>系统调用</li>
</ul>
</li>
</ul>
<h5 id="dynamic-linking">Dynamic Linking<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#dynamic-linking" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>前面介绍的链接方法属于静态链接，虽然它能快速调用库函数，但它具有以下缺陷：不能及时更新库函数，会一次性加载所有库函数（即使很多库函数没被用到）。因此我们更多地会用到<strong>动态链接库</strong>(Dynamically Linked Libraries, DLL) 来克服这些缺陷——这种库可以在程序<strong>运行时</strong>被链接到程序里。<br/>
动态链接库有如下特征：</p>
<ul>
<li>需要可重定位的过程代码</li>
<li>能够避免由静态链接获取所有库函数带来的占用存储空间过大的问题</li>
<li>能够自动获取最新版本的库</li>
</ul>
<h5 id="lazy-linkage">Lazy Linkage<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#lazy-linkage" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<p>在原始版本的 DLL 中，程序和库都需要保留额外的信息，用于定位非局部的过程；加载器会运行一个动态的链接器，使用这些额外的信息找到合适的库并更新所有的外部引用。这种 DLL 的缺点是它仍然会一次性加载所有库函数。一种改进方法是使用<strong>懒过程链接</strong>(Lazy Procedure Linkage) 版本的 DLL，它能保证只有当程序调用库函数时，对应的库才会被链接到程序里。下图展示了这种版本的 DLL：<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251105133635.png" width="auto" height="auto" alt/></p>
<h3 id="数据类型">数据类型<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#数据类型" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="go">go<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#go" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251119144236.png" width="auto" height="auto" alt/></p>
<h4 id="c">c<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#c" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251119144250.png" width="auto" height="auto" alt/><br/>
无论是 32 位还是 64 位系统，<code>long long</code> 类型的大小都是 <strong>8 字节</strong><br/>
<code>long</code> 在 32 位系统上是 4 字节，在 64 位系统上是 8 字节<br/>
<img src="../../课程笔记/计算机组成/attachments/Pasted-image-20251119143736.png" width="auto" height="auto" alt/></p></article><hr/><div class="page-footer"><div class="giscus" data-repo="im0x0ing/im0x0ing.github.io" data-repo-id="R_kgDOQevgrA" data-category="Announcements" data-category-id="DIC_kwDOQevgrM4CzLI8" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-input-position="top" data-light-theme="light" data-dark-theme="dark" data-theme-url="https://im0x0ing.github.io/static/giscus" data-lang="zh-CN"></div></div></div><div class="right sidebar"><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-10" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div class="toc-depth-control"><span class="depth-label">H3</span><input type="range" class="depth-slider" min="1" max="6" value="2" step="1"/></div><ul id="list-9" class="toc-content overflow"><li class="depth-3"><a href="#summary" data-for="summary">summary</a></li><li class="depth-2"><a href="#寄存器-registers-flashcard" data-for="寄存器-registers-flashcard">寄存器 registers flashcard</a></li><li class="depth-2"><a href="#字节地址-flashcard" data-for="字节地址-flashcard">字节地址 flashcard</a></li><li class="depth-2"><a href="#寻址-flashcard" data-for="寻址-flashcard">寻址 flashcard</a></li><li class="depth-2"><a href="#大小端-flashcard" data-for="大小端-flashcard">大小端 flashcard</a></li><li class="depth-2"><a href="#补码-2s-complement-flashcard" data-for="补码-2s-complement-flashcard">补码 2’s complement flashcard</a></li><li class="depth-0"><a href="#指令" data-for="指令">指令</a></li><li class="depth-1"><a href="#设计准则" data-for="设计准则">设计准则</a></li><li class="depth-1"><a href="#指令-1" data-for="指令-1">指令</a></li><li class="depth-2"><a href="#arithmetic" data-for="arithmetic">Arithmetic</a></li><li class="depth-2"><a href="#logical-operations" data-for="logical-operations">Logical Operations</a></li><li class="depth-2"><a href="#bit-operations" data-for="bit-operations">Bit Operations</a></li><li class="depth-2"><a href="#making-decisions" data-for="making-decisions">Making Decisions</a></li><li class="depth-3"><a href="#if" data-for="if">if</a></li><li class="depth-3"><a href="#if-else" data-for="if-else">if-else</a></li><li class="depth-3"><a href="#case-switch" data-for="case-switch">case-switch</a></li><li class="depth-3"><a href="#loops" data-for="loops">loops</a></li><li class="depth-2"><a href="#set-on-less-than" data-for="set-on-less-than">set on less than</a></li><li class="depth-2"><a href="#data-transfer-instructions" data-for="data-transfer-instructions">Data Transfer Instructions</a></li><li class="depth-2"><a href="#立即数-constant-or-immediate-operands" data-for="立即数-constant-or-immediate-operands">立即数 Constant or Immediate Operands</a></li><li class="depth-2"><a href="#同步synchronization-in-risc-v" data-for="同步synchronization-in-risc-v">同步Synchronization in RISC-V</a></li><li class="depth-1"><a href="#其他" data-for="其他">其他</a></li><li class="depth-1"><a href="#伪指令" data-for="伪指令">伪指令</a></li><li class="depth-1"><a href="#过程procedure或函数function" data-for="过程procedure或函数function">过程（Procedure）或函数（Function）</a></li><li class="depth-2"><a href="#调用过程procedure-call-instructions-flashcard" data-for="调用过程procedure-call-instructions-flashcard">调用过程Procedure Call Instructions flashcard</a></li><li class="depth-2"><a href="#调用过程中的寄存器registers-for-procedure-calling" data-for="调用过程中的寄存器registers-for-procedure-calling">调用过程中的寄存器Registers for procedure calling</a></li><li class="depth-2"><a href="#local-data-on-the-stack" data-for="local-data-on-the-stack">Local Data on the Stack</a></li><li class="depth-2"><a href="#memory-layout" data-for="memory-layout">Memory Layout</a></li><li class="depth-0"><a href="#ricv-v指令格式-flashcard" data-for="ricv-v指令格式-flashcard">RICV-V指令格式 flashcard</a></li><li class="depth-0"><a href="#数组和指针" data-for="数组和指针">数组和指针</a></li><li class="depth-0"><a href="#例子" data-for="例子">例子</a></li><li class="depth-0"><a href="#指令集架构" data-for="指令集架构">指令集架构</a></li><li class="depth-2"><a href="#谬误" data-for="谬误">谬误</a></li><li class="depth-2"><a href="#指令集架构-instruction-set-architecture-flashcard" data-for="指令集架构-instruction-set-architecture-flashcard">指令集架构 instruction set architecture flashcard</a></li><li class="depth-1"><a href="#mips" data-for="mips">MIPS</a></li><li class="depth-1"><a href="#x86" data-for="x86">x86</a></li><li class="depth-3"><a href="#寄存器" data-for="寄存器">寄存器</a></li><li class="depth-3"><a href="#寻址模式" data-for="寻址模式">寻址模式</a></li><li class="depth-3"><a href="#指令格式" data-for="指令格式">指令格式</a></li><li class="depth-0"><a href="#translating-and-starting-a-program" data-for="translating-and-starting-a-program">Translating and starting a program</a></li><li class="depth-3"><a href="#dynamic-linking" data-for="dynamic-linking">Dynamic Linking</a></li><li class="depth-3"><a href="#lazy-linkage" data-for="lazy-linkage">Lazy Linkage</a></li><li class="depth-1"><a href="#数据类型" data-for="数据类型">数据类型</a></li><li class="depth-2"><a href="#go" data-for="go">go</a></li><li class="depth-2"><a href="#c" data-for="c">c</a></li><li class="overflow-end"></li></ul></div><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript" data-persist="true">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module" data-persist="true">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript" data-persist="true"></script><script src="../../postscript.js" type="module" data-persist="true"></script></html>