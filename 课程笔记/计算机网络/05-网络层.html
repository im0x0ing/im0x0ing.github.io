<!DOCTYPE html>
<html lang="en" dir="ltr"><head><title>网络层</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto Sans SC:wght@400;700&amp;family=Noto Serif SC:ital,wght@0,400;0,500;0,700;0,900;1,400;1,500;1,700;1,900&amp;family=JetBrains Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="ING wiki"/><meta property="og:title" content="网络层"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="网络层"/><meta name="twitter:description" content="网络层 Network Layer 主要任务 链路层完成的是在一个网络中如何将帧从一个结点传输给另一个结点；或者说是从线路的一边传递到另一边。而网络层则考虑如何将数据包从发送方一路送到接收方[host to host]。在这个过程中，数据包可能会跨越不同的网络（这也是 inter-net 的名字来源）。 使用一些中间设备（或称中间系统、中继系统）可以将两个计算机网络连接起来。 我们之前学到的物理层的中继器 (Repeater)、集线器 (Hub)，以及链路层的网桥 (Bridge)、交换机 (Switch) 都属于中间设备。 我们之前也提到，虽然网桥最初设计被用来处理异构网络之间的互联，但最终..."/><meta property="og:description" content="网络层 Network Layer 主要任务 链路层完成的是在一个网络中如何将帧从一个结点传输给另一个结点；或者说是从线路的一边传递到另一边。而网络层则考虑如何将数据包从发送方一路送到接收方[host to host]。在这个过程中，数据包可能会跨越不同的网络（这也是 inter-net 的名字来源）。 使用一些中间设备（或称中间系统、中继系统）可以将两个计算机网络连接起来。 我们之前学到的物理层的中继器 (Repeater)、集线器 (Hub)，以及链路层的网桥 (Bridge)、交换机 (Switch) 都属于中间设备。 我们之前也提到，虽然网桥最初设计被用来处理异构网络之间的互联，但最终..."/><meta property="og:image:alt" content="网络层 Network Layer 主要任务 链路层完成的是在一个网络中如何将帧从一个结点传输给另一个结点；或者说是从线路的一边传递到另一边。而网络层则考虑如何将数据包从发送方一路送到接收方[host to host]。在这个过程中，数据包可能会跨越不同的网络（这也是 inter-net 的名字来源）。 使用一些中间设备（或称中间系统、中继系统）可以将两个计算机网络连接起来。 我们之前学到的物理层的中继器 (Repeater)、集线器 (Hub)，以及链路层的网桥 (Bridge)、交换机 (Switch) 都属于中间设备。 我们之前也提到，虽然网桥最初设计被用来处理异构网络之间的互联，但最终..."/><meta property="twitter:domain" content="im0x0ing.github.io"/><meta property="og:url" content="https://im0x0ing.github.io/课程笔记/计算机网络/05-网络层"/><meta property="twitter:url" content="https://im0x0ing.github.io/课程笔记/计算机网络/05-网络层"/><link rel="icon" href="../../static/icon.png"/><meta name="description" content="网络层 Network Layer 主要任务 链路层完成的是在一个网络中如何将帧从一个结点传输给另一个结点；或者说是从线路的一边传递到另一边。而网络层则考虑如何将数据包从发送方一路送到接收方[host to host]。在这个过程中，数据包可能会跨越不同的网络（这也是 inter-net 的名字来源）。 使用一些中间设备（或称中间系统、中继系统）可以将两个计算机网络连接起来。 我们之前学到的物理层的中继器 (Repeater)、集线器 (Hub)，以及链路层的网桥 (Bridge)、交换机 (Switch) 都属于中间设备。 我们之前也提到，虽然网桥最初设计被用来处理异构网络之间的互联，但最终..."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" data-persist="true"/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvaW0weDBpbmctYmxvZy1wcml2YXRlL2ltMHgwaW5nLWJsb2ctcHJpdmF0ZS9xdWFydHovY29tcG9uZW50cy9zdHlsZXMiLCJzb3VyY2VzIjpbIm1lcm1haWQuaW5saW5lLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTtFQUNBOztBQUdGO0VBQ0U7OztBQUtGO0VBQ0U7RUFDQTs7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBSUo7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTs7QUFFQTtFQUNFOztBQUdGO0VBQ0U7O0FBSUY7RUFDRTtFQUNBO0VBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyIuZXhwYW5kLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgZGlzcGxheTogZmxleDtcbiAgZmxvYXQ6IHJpZ2h0O1xuICBwYWRkaW5nOiAwLjRyZW07XG4gIG1hcmdpbjogMC4zcmVtO1xuICByaWdodDogMDsgLy8gTk9URTogcmlnaHQgd2lsbCBiZSBzZXQgaW4gbWVybWFpZC5pbmxpbmUudHNcbiAgY29sb3I6IHZhcigtLWdyYXkpO1xuICBib3JkZXItY29sb3I6IHZhcigtLWRhcmspO1xuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gIGJvcmRlcjogMXB4IHNvbGlkO1xuICBib3JkZXItcmFkaXVzOiA1cHg7XG4gIG9wYWNpdHk6IDA7XG4gIHRyYW5zaXRpb246IDAuMnM7XG5cbiAgJiA+IHN2ZyB7XG4gICAgZmlsbDogdmFyKC0tbGlnaHQpO1xuICAgIGZpbHRlcjogY29udHJhc3QoMC4zKTtcbiAgfVxuXG4gICY6aG92ZXIge1xuICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICBib3JkZXItY29sb3I6IHZhcigtLXNlY29uZGFyeSk7XG4gIH1cblxuICAmOmZvY3VzIHtcbiAgICBvdXRsaW5lOiAwO1xuICB9XG59XG5cbnByZSB7XG4gICY6aG92ZXIgPiAuZXhwYW5kLWJ1dHRvbiB7XG4gICAgb3BhY2l0eTogMTtcbiAgICB0cmFuc2l0aW9uOiAwLjJzO1xuICB9XG59XG5cbiNtZXJtYWlkLWNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiBmaXhlZDtcbiAgY29udGFpbjogbGF5b3V0O1xuICB6LWluZGV4OiA5OTk7XG4gIGxlZnQ6IDA7XG4gIHRvcDogMDtcbiAgd2lkdGg6IDEwMHZ3O1xuICBoZWlnaHQ6IDEwMHZoO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICBkaXNwbGF5OiBub25lO1xuICBiYWNrZHJvcC1maWx0ZXI6IGJsdXIoNHB4KTtcbiAgYmFja2dyb3VuZDogcmdiYSgwLCAwLCAwLCAwLjUpO1xuXG4gICYuYWN0aXZlIHtcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIH1cblxuICAmID4gI21lcm1haWQtc3BhY2Uge1xuICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tbGlnaHQpO1xuICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICBwb3NpdGlvbjogZml4ZWQ7XG4gICAgdG9wOiA1MCU7XG4gICAgbGVmdDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xuICAgIGhlaWdodDogODB2aDtcbiAgICB3aWR0aDogODB2dztcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRlbnQge1xuICAgICAgcGFkZGluZzogMnJlbTtcbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIHRyYW5zZm9ybS1vcmlnaW46IDAgMDtcbiAgICAgIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjFzIGVhc2U7XG4gICAgICBvdmVyZmxvdzogdmlzaWJsZTtcbiAgICAgIG1pbi1oZWlnaHQ6IDIwMHB4O1xuICAgICAgbWluLXdpZHRoOiAyMDBweDtcblxuICAgICAgcHJlIHtcbiAgICAgICAgbWFyZ2luOiAwO1xuICAgICAgICBib3JkZXI6IG5vbmU7XG4gICAgICB9XG5cbiAgICAgIHN2ZyB7XG4gICAgICAgIG1heC13aWR0aDogbm9uZTtcbiAgICAgICAgaGVpZ2h0OiBhdXRvO1xuICAgICAgfVxuICAgIH1cblxuICAgICYgPiAubWVybWFpZC1jb250cm9scyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICBib3R0b206IDIwcHg7XG4gICAgICByaWdodDogMjBweDtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBnYXA6IDhweDtcbiAgICAgIHBhZGRpbmc6IDhweDtcbiAgICAgIGJhY2tncm91bmQ6IHZhcigtLWxpZ2h0KTtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpZ2h0Z3JheSk7XG4gICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgei1pbmRleDogMjtcblxuICAgICAgLm1lcm1haWQtY29udHJvbC1idXR0b24ge1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcbiAgICAgICAgd2lkdGg6IDMycHg7XG4gICAgICAgIGhlaWdodDogMzJweDtcbiAgICAgICAgcGFkZGluZzogMDtcbiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgICBjb2xvcjogdmFyKC0tZGFyayk7XG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBmb250LXNpemU6IDE2cHg7XG4gICAgICAgIGZvbnQtZmFtaWx5OiB2YXIoLS1ib2R5Rm9udCk7XG4gICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzIGVhc2U7XG5cbiAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgICAgfVxuXG4gICAgICAgICY6YWN0aXZlIHtcbiAgICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoMXB4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0eWxlIHRoZSByZXNldCBidXR0b24gZGlmZmVyZW50bHlcbiAgICAgICAgJjpudGgtY2hpbGQoMikge1xuICAgICAgICAgIHdpZHRoOiBhdXRvO1xuICAgICAgICAgIHBhZGRpbmc6IDAgMTJweDtcbiAgICAgICAgICBmb250LXNpemU6IDE0cHg7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ== */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" data-persist="true"/><script src="../../prescript.js" type="application/javascript" data-persist="true"></script><script type="application/javascript" data-persist="true">const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://im0x0ing.github.io/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://im0x0ing.github.io/课程笔记/计算机网络/05-网络层-og-image.webp"/><meta property="og:image:url" content="https://im0x0ing.github.io/课程笔记/计算机网络/05-网络层-og-image.webp"/><meta name="twitter:image" content="https://im0x0ing.github.io/课程笔记/计算机网络/05-网络层-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="课程笔记/计算机网络/05-网络层"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../..">ING wiki</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>Search</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slug===\&quot;\&quot;||node.slug.startsWith(\&quot;\\u8BFE\\u7A0B\\u7B14\\u8BB0\&quot;)&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-165"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-165" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-3"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><header><nav class="my-navbar "><div class="links"><a href="/课程笔记/">课程笔记</a><a href="/技术积累/">技术积累</a><a href="/工具使用/">工具使用</a><a href="/生活杂谈/">生活杂谈</a></div></nav></header><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../课程笔记/">课程笔记</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../课程笔记/计算机网络/">计算机网络</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>网络层</a></div></nav><h1 class="article-title">网络层</h1><p show-comma="true" class="content-meta"><time datetime="2026-01-14T16:37:00.000Z">Jan 14, 2026</time><span>19 min read</span></p></div></div><article class="popover-hint"><h2 id="网络层-network-layer">网络层 Network Layer<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#网络层-network-layer" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="主要任务">主要任务<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#主要任务" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>链路层完成的是在一个网络中如何<span class="text-highlight">将帧从一个结点传输给另一个结点</span>；或者说是从线路的一边传递到另一边。而网络层则考虑如何将数据包从<span class="text-highlight">发送方一路送到接收方</span><span class="orange-comment">[host to host]</span>。在这个过程中，数据包可能会跨越不同的网络（这也是 inter-net 的名字来源）。</p>
<ul>
<li>使用一些<span class="text-highlight">中间设备</span>（或称中间系统、中继系统）可以将两个计算机网络连接起来。
<ul>
<li>我们之前学到的物理层的中继器 (Repeater)、集线器 (Hub)，以及链路层的网桥 (Bridge)、交换机 (Switch) 都属于中间设备。</li>
<li>我们之前也提到，虽然网桥最初设计被用来处理异构网络之间的互联，但最终这部分任务被留给了网络层；<span class="text-highlight">即，我们认为上述设备只是扩大了网络，并没有连接不同的网络。</span></li>
</ul>
</li>
<li>因此我们引入<span class="text-highlight">网路层的中间设备</span>：<strong>路由器 (Router)</strong>
<ul>
<li>它负责连接不同的网络，为到来的跨网络的数据包根据其目的地找到一条路径，并对应地将其转发。</li>
</ul>
</li>
<li>在更高层还有<span class="text-highlight">网关 (Gateway) 这一中间设备</span>。由于一些历史原因，路由器有时也被称为网关。</li>
</ul>
<p>我们说，网络层是处理端到端数据传输的最底层。这是因为，链路层考虑的只是将数据从网络上的一个结点发给另一个结点，而我们实际上需要做的是将一个进程的数据传递给另一个进程。如下图所示，发送方 H1 上的进程 P1 将信息传递给 ISP（网络应用提供商）提供的设备 A，ISP 的路由器为数据包找到一条通路并转发给接收方的路由器 F，最终由接收方 H2 的进程 P2 接受。网络层首先完成了从主机到主机的数据传输。</p>
<p>具体的过程是， A host with a packet to send transmits it to the nearest router, either on its own LAN or over a point-to-point link to the ISP. The packet is stored there until it has fully arrived and the link has finished its processing by verifying the checksum. Then it is forwarded to the next router along the path until it reaches the destination host. This mechanism is store-and-forward packet switching.</p>
<p>除了将异构网络互联、通过路由和转发实现任意网络结点间的数据传输以外，网络层还关注拥塞控制 (congestion control) 和服务质量 (quality of service) 等话题。</p>
<h3 id="提供给传输层的服务">提供给传输层的服务<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#提供给传输层的服务" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>正如在数据链路层中讨论的那样，我们在网络层也需要考虑提供面向连接的还是无连接的服务。</p>
<ul>
<li>以 Internet community 为代表的一方认为，无论如何设计网路，本质上它就是不可靠的，因此网络服务应该是无连接的。</li>
<li>以电话公司为代表的另一方认为，网络应该提供可靠的面向连接的服务。<br/>
实际上，无连接服务获得了成功。但是 Internet 也渐渐朝着面向连接的特性进化，因为服务质量变得越来越重要了。与此相关的两个面向连接技术的例子是 MPLS 和 VLAN。我们在链路层已经讨论过了 VLAN，在网络层中我们会讨论 MPLS。</li>
</ul>
<p>但无论如何，<strong>提供给传输层的服务应当屏蔽不同的路由器技术，以及网络上的路由器数量、类型和拓扑关系</strong>。传输层可用的网络地址也应当有一套可以跨越 LAN 甚至 WAN 的统一编址方案。</p>
<h4 id="无连接服务的实现数据报网络-datagram-network">无连接服务的实现：数据报网络 datagram network<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#无连接服务的实现数据报网络-datagram-network" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>我们在物理层讨论了三种不同的交换方式，包交换 packet switching 是其中一种。在这里，我们进一步考察包交换的实现方式。我们将每个数据包独立注入网络中，并且为每个数据包独立路由（即，为每个数据包分别进行一次寻路）。在这种方式中，我们称数据包为 <strong>数据报 datagram</strong>，这种网络称为 <strong>数据报网络 datagram network</strong>。</li>
<li>这种方式中，<span class="text-highlight">每个数据报的首部需要保存其目的地址；每个路由器根据该地址进行寻路。</span></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637652466053-2c9f0da5-45ce-4da7-bff5-2c2e888f9e68.png" alt/></li>
</ul>
<h4 id="面向连接服务的实现虚电路网络-virtual-circuit-network">面向连接服务的实现：虚电路网络 virtual-circuit network<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#面向连接服务的实现虚电路网络-virtual-circuit-network" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>虚电路网络也是包交换的一种实现方式。虚电路不希望给每个数据包选择一条路径，而希望建立一个连接，选择一条固定的路径；所有需要从这个连接上通过的流量都使用这条路径。</li>
<li>虚电路之所以是“虚”的，是因为这条电路不是专用的，只是逻辑上的。一条链路上可能有多个虚电路通过，一对 host 之间也可能存在多条不同的虚电路。</li>
<li>如下图所示，每个连接有一个连接标识符 connection identifier；路由器 A 的表中的第一行表示：如果有一个来自 H1 的、标识符为 1 的包，那么 A 将其转发给 C，且标识符为 1。这种方式中，每个数据报不需要保存目的地址，而是保存 connection identifier。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637654549320-b135d94e-235b-4d66-a4c6-9ad8d9b6db28.png" alt/></li>
</ul>
<h5 id="mpls-multiprotocol-label-switching">MPLS (MultiProtocol Label Switching)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mpls-multiprotocol-label-switching" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h5>
<ul>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638117982702-a750caae-b392-4c62-9df5-39f39d3e0137.png" alt/></li>
</ul>
<h4 id="数据报网络和虚电路网络的比较">数据报网络和虚电路网络的比较<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#数据报网络和虚电路网络的比较" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637655976794-7108a78e-347d-4b53-9019-d01fbeb5ced6.png" alt/></li>
<li>One trade-off is setup time versus address parsing time. Using virtual circuits requires a setup phase, which takes time and consumes resources. However, once this price is paid, figuring out what to do with a data packet in a virtual-circuit network is easy: the router just uses the circuit number to index into a table to find out where the packet goes. In a datagram network, no setup is needed but a more complicated lookup procedure is required to locate the entry for the destination.</li>
<li>A related issue is that the destination addresses used in datagram networks are longer than circuit numbers used in virtual-circuit networks because they have a global meaning. If the packets tend to be fairly short, including a full destination address in every packet may represent a significant amount of overhead, and hence a waste of bandwidth.</li>
<li>Virtual circuits have some advantages in guaranteeing quality of service and avoiding congestion within the network because resources (e.g., buffers, bandwidth, and CPU cycles) can be reserved in advance, when the connection is established. Once the packets start arriving, the necessary bandwidth and router capacity will be there. With a datagram network, congestion avoidance is more difficult.</li>
<li>事务处理系统适合数据报，长期的流量连接适合虚电路（手工建立，持续使用）。</li>
<li>Virtual circuits also have a vulnerability（脆弱性） problem. If a router crashes and loses its memory, even if it comes back up a second later, all the virtual circuits passing through it will have to be aborted. In contrast, if a datagram router goes down, only those users whose packets were queued in the router at the time need suffer (and probably not even then since the sender is likely to retransmit them shortly). The loss of a communication line is fatal to virtual circuits using it, but can easily be compensated for if datagrams are used.</li>
<li>Datagrams also allow the routers to balance the traffic throughout the network, since routes can be changed partway through a long sequence of packet transmissions.</li>
</ul>
<h3 id="路由算法"><strong>路由算法</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#路由算法" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>路由器的功能是 路由 routing 和 转发 forwarding。路由是指根据特定的路由算法构造出路由表，同时不断进行更新维护；而转发是指根据到来的数据包的内容查询路由表并从合适的端口转发出去。</p>
<h4 id="路由算法-1">路由算法<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#路由算法-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>
<p>虚电路网络只在建立一条新的虚电路时才需要做路由决策，因此这种情形也称为 会话路由 session routing。</p>
</li>
<li>
<p>路由算法可以按是否根据当前网络的流量和拓扑结构调整路由决策分为两大类</p>
</li>
<li>
<p>静态路由 static routing / 非适应性算法 nonadaptive algorithm。简便，开销较小，在拓扑变化不大、路由选择非常清楚的场合很有用；但无法响应故障。</p>
</li>
<li>
<p>动态路由 dynamic routing / 适应性算法 adaptive algorithm。能够改善网络性能，有助于流量控制，收到故障的影响较小。但是算法较为复杂，会增加网络负担。另外如果变化太快容易引起震荡，变化过慢会影响路由的一致性。在 where they get their information (e.g., locally, from adjacent routers, or from all routers), when they change the routes (e.g., when the topology changes, or every ΔT seconds as the load changes), and what metric（度量标准）is used for optimization (e.g., distance, number of hops, or estimated transit time) 等方面有多种选择。</p>
</li>
<li>
<p>Sink tree is not necessarily unique<img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637675068830-dabe6da2-61d0-4e0e-9d15-1a3db767039b.png" alt/></p>
</li>
</ul>
<h4 id="shortest-path">Shortest Path<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#shortest-path" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637675497289-ba589e55-e3a5-4f7e-86b5-a80e8be8f6f0.png" alt/></li>
<li>Dijkstra’s Algorithm</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637675570012-a24c6bae-2acc-48d7-b421-1b7eb2cb327b.png" alt/></li>
</ul>
<h4 id="flooding">Flooding<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#flooding" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637712672003-ed0d8a36-0604-4429-885c-f82e5143bd7c.png" alt/></p>
<h4 id="distance-vector-routing--bellman-ford-routing">Distance Vector Routing / Bellman-Ford Routing<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#distance-vector-routing--bellman-ford-routing" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637714738195-5eed0d30-6a45-4902-bcca-8c55d2683d7e.png" alt/></p>
<ul>
<li>The settling of routes to best paths across the network is called convergence (收敛). Although Distance Vector Routing converges to the correct answer, it may do so slowly. In particular, it reacts rapidly to good news, but leisurely to bad news.</li>
<li>(a) After init, A started; (b) After init, A halted<img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637714765074-d67abd1d-053b-41e5-a46b-e0c134033da7.png" alt/></li>
<li>At the first packet exchange, B does not hear anything from A. Fortunately, C says “Do not worry; I have a path to A of length 2.” Little does B suspect that C’s path runs through B itself. …However, none of these heuristics work well in practice despite the colorful names. The core of the problem is that when X tells Y that it has a path somewhere, Y has no way of knowing whether it itself is on the path.</li>
<li>Problems: 1. 发的东西太长了，占带宽； 2. converge 太慢了</li>
</ul>
<h4 id="link-state-routing">Link State Routing<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#link-state-routing" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>基本过程：与邻居交流，了解其网络地址和交流成本；将这些信息构造成数据包，发给其他所有路由器，也接收其他路由器的数据包；根据这些数据包在本地构造出整个网络的拓扑，并用 Dijkstra’s algorithm 算出到每个结点的最短路。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637721649583-84b60c39-4e41-49ab-8cc8-ec265ab19b87.png" alt/></li>
<li>Use an artificial node N. One designated router on the LAN is selected to play the role of N in the routing protocol<img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637721718703-b8954f3f-3b45-4c86-8bb3-2bcb9fca66d2.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637721925624-6db305c9-ec80-45f7-a637-1d8337f4e34c.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637722007755-eff1dcf5-0aac-4d8c-a490-73deb6b6710f.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637722042082-b2bf5f2d-46e8-452f-9f01-2345333980ed.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637722273350-a2615ee0-20fc-4521-9166-45ee398f67a5.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637742282632-b1ef4731-a55a-4ea6-8d32-21b993bdb5fa.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637745506464-936692a2-2764-4f57-b6d3-bd67d9c2be91.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637745638079-4f4073a2-6cb1-40e3-acb6-4ceec3026a28.png" alt/></li>
</ul>
<h4 id="hierarchical-routing">Hierarchical Routing<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#hierarchical-routing" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637747425795-f376d1ce-9aca-4f87-8001-5101021434f0.png" alt/></p>
<h3 id="拥塞控制">拥塞控制<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#拥塞控制" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h3 id="服务质量">服务质量<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#服务质量" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h3 id="网络互联">网络互联<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#网络互联" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="不同协议的路由策略">不同协议的路由策略<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#不同协议的路由策略" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>具体如何在异构网络之间转发呢？有下面两种思路：</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637653669147-7e1e0394-f47b-4c66-ae78-5d76a400f1e1.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637823679531-6febef8c-d19e-493a-8313-08f524d77102.png" alt/></li>
</ul>
<h4 id="packet-fragmentation">Packet Fragmentation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#packet-fragmentation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>Each network imposes some maximum packet size: MTU, Maximum Transmission Unit. 由于路由，源端很难得知路径上的 MTU。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637832836584-cac4975b-ddc7-4b98-831a-64a4514d70bd.png" alt/></li>
<li>问题：(a) 拆分重组和重复工作、不能分别路由，以及 (b) 判断结尾、额外开销、错误率提升。Nontransparent fragmentation:</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637897676511-b238ca39-3693-4869-a30a-120d97c8d29c.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637897745927-debe71b7-11ed-4c40-add9-c8020d7e2721.png" alt/></li>
</ul>
<h3 id="internet-protocol">Internet Protocol<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#internet-protocol" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="ipv4">IPv4<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ipv4" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>
<p>Header (20-byte fixed + options) + Body / Payload</p>
</li>
<li>
<p>Header 格式<br/>
<img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638088752460-2d43698c-4527-4aa0-a39f-236b10207bd2.png" alt/></p>
</li>
<li>
<p>传输顺序。 The bits are transmitted from left to right and top to bottom, with the high-order bit of the Version field going first. (This is a “big-endian” network byte order. On little-endian machines, such as Intel x86 computers, a software conversion is required on both transmission and reception.) In retrospect, little endian would have been a better choice, but at the time IP was designed, no one knew it would come to dominate computing.</p>
</li>
<li>
<p>Version - 4 (0100) for IPv4</p>
</li>
<li>
<p>IHL (Internet Header Length) - 4 bits, 5~15, in 32-bit words. E.g. IHL = 5 表示头部有 5*32 bits = 20 Bytes，即 Option 字段长度为 0。因此 Option 字段最多 40 Bytes</p>
</li>
<li>
<p>Total length - 16 bits, in Byte, Head + Body, <span>⇐</span>65536</p>
</li>
<li>
<p>Identification - 16 bits, all the fragments of a packet contain the same Identification value.</p>
</li>
<li>
<p>Unused DF (Don’t Fragment) - can be used in path MTU discovery MF (More Fragments) - 0 for the last fragment</p>
</li>
<li>
<p>Fragment offset - All fragments except the last one in a datagram must be a multiple of 8 bytes</p>
</li>
<li>
<p>TTL - 设计为按秒计，现在按 hop 计。When it hits zero, the packet is discarded and a warning packet is sent back to the source host. This feature prevents packets from wandering around forever, something that otherwise might happen if the routing tables ever become corrupted</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638092417699-e668d86e-181f-4cf3-af24-d8f7d1c135c2.png" alt/></p>
</li>
<li>
<p>Checksum - 之前讨论过的 Internet Checksum，16 bits 划分。注意每一跳后 TTL 都会变所以 the Header checksum is assumed to be zero upon arrival 然后重新算一遍。</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638089853333-872ded05-6a97-4efe-86c3-f63a163121ea.png" alt/></p>
</li>
<li>
<p>The Options field was designed to provide an escape to allow subsequent versions of the protocol 1) to include information not present in the original design, 2) to permit experimenters to try out new ideas, and to 3) avoid allocating header bits to information that is rarely needed. The options are of variable length. Each begins with a 1-byte code identifying the option. Some options are followed by a 1-byte option length field, and then one or more data bytes. The Options field is padded out to a multiple of 4 bytes.</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638092781424-d77419e8-934d-471a-8f90-42db9387f250.png" alt/></p>
</li>
<li>
<p>IPv4 地址</p>
</li>
<li>
<p>Internet 上的每个 host 和 router 都有 IP 地址。需要注意的是，每个 IP 地址指向的不是一台机器，而是一个 network interface；例如 router 有多个接口，因此每个接口都有一个 IP 地址。</p>
</li>
<li>
<p>IP 地址具有层次性。Each 32-bit address is comprised of a variable-length network portion in the top bits and a host portion in the bottom bits. The network portion has the same value for all hosts on a single network, such as an Ethernet LAN. This means that a network corresponds to a contiguous block of IP address space. This block is called a prefix.Subnet mask. Since the prefix length cannot be inferred from the IP address alone, routing protocols must carry the prefixes to routers. Sometimes prefixes are simply described by their length, as in a “/16” which is pronounced “slash 16”.IP addresses are written in dotted decimal notation.</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638096149296-de74b274-d97f-4236-9276-7e2d4876f413.png" alt/></p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638096215648-9f37d171-9878-4bdc-962d-6d8a0cbafad3.png" alt/></p>
</li>
<li>
<p>Classful Addressing</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638096416857-9bef3db1-a10f-4ed4-9ac7-eb5cf78518a9.png" alt/></p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638099723529-7296cfaa-0864-43da-ad2e-620ed5d9fb12.png" alt/></p>
</li>
<li>
<p>0.0.0.0：As source addr when booting, this host doesn’t know its IP addr and trying to acquire one (DHCP); As dest addr / socket listening: all, including 127.<em>.</em>.<em>127.</em>.<em>.</em>: Loopback. Not actually on the link.</p>
</li>
<li>
<p>Subnet</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638102529182-ca8522f3-efe9-4a48-84a0-1d8091b75450.png" alt/></p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638102559002-c6463593-192e-4a5a-a88e-ecab035a1945.png" alt/></p>
</li>
<li>
<p>Outside the network, the subnetting is not visible, so allocating a new subnet does not require contacting ICANN or changing any external databases.</p>
</li>
<li>
<p>CIDR, Classless Inter-Domain Routing</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638103542205-2a192e73-c35d-436e-8a5a-36353bad77b8.png" alt/></p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638103678342-4bf4899a-af01-40a7-a1d6-9a4ceba1c63d.png" alt/></p>
</li>
<li>
<p>NAT</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638104715025-5f9ed314-1567-4db6-9b19-12eaca7c6f54.png" alt/></p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638104728409-4aa2dffd-7785-42e8-83fb-2bfaf253cbb6.png" alt/></p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638105160848-f79c4094-f941-4e4f-9801-6dec0f6fffec.png" alt/></p>
</li>
</ul>
<h4 id="ipv6">IPv6<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ipv6" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638107011983-aca8c3b1-38bf-4b76-90cf-b7c7dda51603.png" alt/></li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638107482548-f2fa8ea5-3886-4752-8bcd-371227297844.png" alt/></li>
</ul>
<h4 id="internet-control-protocols">Internet Control Protocols<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#internet-control-protocols" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>
<p>In addition to IP, which is used for data transfer, the Internet has several companion control protocols that are used in the network layer.</p>
</li>
<li>
<p>ARP</p>
</li>
<li>
<p><img src="../../课程笔记/计算机网络/attachments/Pasted-image-20251123212043.png" width="auto" height="auto" alt/></p>
</li>
<li>
<p>DHCP</p>
</li>
<li>
<p><img src="../../课程笔记/计算机网络/attachments/Pasted-image-20251123212051.png" width="auto" height="auto" alt/></p>
</li>
<li>
<p>ICMP</p>
</li>
<li>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638109150809-666e153e-73d0-4f4e-a220-539960e6f99e.png" alt/></p>
</li>
</ul>
<h3 id="路由协议">路由协议<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#路由协议" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="互联网路由">互联网路由<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#互联网路由" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>问题：不同的路由算法、不同的度量方式、对外保护网络内部细节、太大</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1637827416902-b9358a81-158a-4c74-ad98-4bd170bebaef.png" alt/></li>
<li>Within each network (OR AS, Autonomous System), an intradomain or interior gateway protocol is used for routing. (“Gateway” is an older term for “router”.) Across the networks that make up the internet, an interdomain or exterior gateway protocol is used. The networks may all use different intradomain protocols, but they must use the same interdomain protocol.</li>
</ul>
<h4 id="rip-routing-information-protocol">RIP, Routing Information Protocol<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#rip-routing-information-protocol" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>一种 Interior Gateway Protocol，基于 Distance Vector Routing，用 hop 计量距离。规定一条路径最多包含 15 个 router（即 15 个 hop），从而防止环路；可见只适用于小型网络。每 30s 在 相邻 的路由器之间交换一次信息，即自己当前的路由表，以维护路由表。</li>
<li>是一个应用层协议，需要借助 UDP，端口号是 520。</li>
</ul>
<h4 id="ospf-open-shortest-path-first">OSPF, Open Shortest Path First<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ospf-open-shortest-path-first" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>也是一种 Interior Gateway Protocol，直接使用 IP Packet 发送，protocol 字段值为 89。Open 是指该协议发布在公开文献中。</li>
<li>支持根据 IP Packet 的不同 services 使用不同的路由方式，从而更好地传输实时流量。 支持多种距离度量，支持多路径之间的负载平衡，支持层次系统，提供一定安全性，支持隧道。</li>
<li>每个 AS 内部也有层次结构：有一个 Backbone Area；其他任意两个区域之间可以通过 Backbone Area 互达。</li>
<li>基于 Link State Routing。</li>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/641515/1638535364642-618ac38e-509a-4cc2-aa73-84f9f32c9bae.png" alt/></li>
</ul>
<h4 id="bgp-border-gateway-protocol">BGP, Border Gateway Protocol<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#bgp-border-gateway-protocol" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li>Internet 使用的 Exterior Gateway Protocol。每个 AS 需要选择至少一个 router 作为发言人。基于 Distance Vector Routing；但实际上不一定是最优的，因为考虑优先使用对等网络以及各种限制等实际的政策原因，同时网络太大也不一定能找到最佳。另外还维护到目的地的路径，因此叫 Path Vector Protocol。</li>
<li>应用层协议，基于 TCP，端口号 179。</li>
</ul>
<h3 id="ip-组播">IP 组播<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#ip-组播" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h3 id="移动-ip">移动 IP<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#移动-ip" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>ICMP 的 ROUTER ADVERTISEMENT/SOLICITATION 消息使得主机可以找到附近的路由器。当主机发现路由器不一样的时候，就知道自己跑了。</p>
<p>主机在新的网络 (foreign / remote agent) 通过 DHCP 获得一个新的 IP 地址，然后告诉自己的老家 (home agent) 自己现在在哪。</p>
<p>Home agent 需要拦截发给这个跑路了的主机的包，方法是当路由器通过 ARP 询问跑路主机持有的 IP 对应什么 MAC 地址时，回答自己的 MAC 地址。这就是 ARP agent。为了快速更新，home agent 也可以发 Gratuitous ARP（无故 ARP），问跑路主机的 IP 对应的 MAC 并自己回答。</p>
<h4 id="剩下的步骤如下图">剩下的步骤如下图：<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#剩下的步骤如下图" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4></article><hr/><div class="page-footer"><div class="giscus" data-repo="im0x0ing/im0x0ing.github.io" data-repo-id="R_kgDOQevgrA" data-category="Announcements" data-category-id="DIC_kwDOQevgrM4CzLI8" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-input-position="top" data-light-theme="light" data-dark-theme="dark" data-theme-url="https://im0x0ing.github.io/static/giscus" data-lang="zh-CN"></div></div></div><div class="right sidebar"><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-96" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div class="toc-depth-control"><span class="depth-label">H3</span><input type="range" class="depth-slider" min="1" max="6" value="2" step="1"/></div><ul id="list-9" class="toc-content overflow"><li class="depth-0"><a href="#网络层-network-layer" data-for="网络层-network-layer">网络层 Network Layer</a></li><li class="depth-1"><a href="#主要任务" data-for="主要任务">主要任务</a></li><li class="depth-1"><a href="#提供给传输层的服务" data-for="提供给传输层的服务">提供给传输层的服务</a></li><li class="depth-2"><a href="#无连接服务的实现数据报网络-datagram-network" data-for="无连接服务的实现数据报网络-datagram-network">无连接服务的实现：数据报网络 datagram network</a></li><li class="depth-2"><a href="#面向连接服务的实现虚电路网络-virtual-circuit-network" data-for="面向连接服务的实现虚电路网络-virtual-circuit-network">面向连接服务的实现：虚电路网络 virtual-circuit network</a></li><li class="depth-3"><a href="#mpls-multiprotocol-label-switching" data-for="mpls-multiprotocol-label-switching">MPLS (MultiProtocol Label Switching)</a></li><li class="depth-2"><a href="#数据报网络和虚电路网络的比较" data-for="数据报网络和虚电路网络的比较">数据报网络和虚电路网络的比较</a></li><li class="depth-1"><a href="#路由算法" data-for="路由算法">路由算法</a></li><li class="depth-2"><a href="#路由算法-1" data-for="路由算法-1">路由算法</a></li><li class="depth-2"><a href="#shortest-path" data-for="shortest-path">Shortest Path</a></li><li class="depth-2"><a href="#flooding" data-for="flooding">Flooding</a></li><li class="depth-2"><a href="#distance-vector-routing--bellman-ford-routing" data-for="distance-vector-routing--bellman-ford-routing">Distance Vector Routing / Bellman-Ford Routing</a></li><li class="depth-2"><a href="#link-state-routing" data-for="link-state-routing">Link State Routing</a></li><li class="depth-2"><a href="#hierarchical-routing" data-for="hierarchical-routing">Hierarchical Routing</a></li><li class="depth-1"><a href="#拥塞控制" data-for="拥塞控制">拥塞控制</a></li><li class="depth-1"><a href="#服务质量" data-for="服务质量">服务质量</a></li><li class="depth-1"><a href="#网络互联" data-for="网络互联">网络互联</a></li><li class="depth-2"><a href="#不同协议的路由策略" data-for="不同协议的路由策略">不同协议的路由策略</a></li><li class="depth-2"><a href="#packet-fragmentation" data-for="packet-fragmentation">Packet Fragmentation</a></li><li class="depth-1"><a href="#internet-protocol" data-for="internet-protocol">Internet Protocol</a></li><li class="depth-2"><a href="#ipv4" data-for="ipv4">IPv4</a></li><li class="depth-2"><a href="#ipv6" data-for="ipv6">IPv6</a></li><li class="depth-2"><a href="#internet-control-protocols" data-for="internet-control-protocols">Internet Control Protocols</a></li><li class="depth-1"><a href="#路由协议" data-for="路由协议">路由协议</a></li><li class="depth-2"><a href="#互联网路由" data-for="互联网路由">互联网路由</a></li><li class="depth-2"><a href="#rip-routing-information-protocol" data-for="rip-routing-information-protocol">RIP, Routing Information Protocol</a></li><li class="depth-2"><a href="#ospf-open-shortest-path-first" data-for="ospf-open-shortest-path-first">OSPF, Open Shortest Path First</a></li><li class="depth-2"><a href="#bgp-border-gateway-protocol" data-for="bgp-border-gateway-protocol">BGP, Border Gateway Protocol</a></li><li class="depth-1"><a href="#ip-组播" data-for="ip-组播">IP 组播</a></li><li class="depth-1"><a href="#移动-ip" data-for="移动-ip">移动 IP</a></li><li class="depth-2"><a href="#剩下的步骤如下图" data-for="剩下的步骤如下图">剩下的步骤如下图：</a></li><li class="overflow-end"></li></ul></div><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2026</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="https://discord.gg/cRFFHYye7t">Discord Community</a></li></ul></footer></div></div></body><script type="application/javascript" data-persist="true">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module" data-persist="true">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript" data-persist="true"></script><script src="../../postscript.js" type="module" data-persist="true"></script></html>